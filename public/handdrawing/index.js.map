{"version":3,"file":"index.js","mappings":"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","sources":["webpack:///./node_modules/.pnpm/@niuee+board@0.0.7/node_modules/@niuee/board/boardify/index.js","webpack:///./src/handdrawing/index.ts"],"sourcesContent":["function clampZoomLevel(zoomLevel,zoomLevelLimits){return zoomLevelWithinLimits(zoomLevel,zoomLevelLimits)||void 0===zoomLevelLimits||(zoomLevelLimits.max&&(zoomLevel=Math.min(zoomLevelLimits.max,zoomLevel)),zoomLevelLimits.min&&(zoomLevel=Math.max(zoomLevelLimits.min,zoomLevel))),zoomLevel}function zoomLevelWithinLimits(zoomLevel,zoomLevelLimits){return void 0===zoomLevelLimits||!(zoomLevel<=0||void 0!==zoomLevelLimits&&(void 0!==zoomLevelLimits.max&&zoomLevelLimits.max<zoomLevel||void 0!==zoomLevelLimits.min&&zoomLevelLimits.min>zoomLevel))}class PointCal{static addVector(a,b){return null==a.z&&null==b.z?{x:a.x+b.x,y:a.y+b.y}:(null!=a.z&&null!=b.z||(null==a.z&&(a.z=0),null==b.z&&(b.z=0)),{x:a.x+b.x,y:a.y+b.y,z:a.z+b.z})}static subVector(a,b){return null==a.z&&null==b.z?{x:a.x-b.x,y:a.y-b.y}:(null!=a.z&&null!=b.z||(null==a.z&&(a.z=0),null==b.z&&(b.z=0)),{x:a.x-b.x,y:a.y-b.y,z:a.z-b.z})}static multiplyVectorByScalar(a,b){return null==a.z?{x:a.x*b,y:a.y*b}:{x:a.x*b,y:a.y*b,z:a.z*b}}static divideVectorByScalar(a,b){return 0==b?{x:a.x,y:a.y}:null==a.z?{x:a.x/b,y:a.y/b}:{x:a.x/b,y:a.y/b,z:a.z/b}}static magnitude(a){return null==a.z&&(a.z=0),Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}static unitVector(a){return null==a.z&&(a.z=0),0!=this.magnitude(a)?{x:a.x/this.magnitude(a),y:a.y/this.magnitude(a),z:a.z/this.magnitude(a)}:{x:0,y:0,z:0}}static dotProduct(a,b){return null==a.z&&null==b.z?a.x*b.x+a.y*b.y:(null!=a.z&&null!=b.z||(null==a.z&&(a.z=0),null==b.z&&(b.z=0)),a.x*b.x+a.y*b.y+a.z*b.z)}static crossProduct(a,b){return null!=a.z&&null!=b.z||(null==a.z&&(a.z=0),null==b.z&&(b.z=0)),{x:a.y*b.z-a.z*b.y,y:a.z*b.x-a.x*b.z,z:a.x*b.y-a.y*b.x}}static unitVectorFromA2B(a,b){return this.unitVector(this.subVector(b,a))}static rotatePoint(point,angle){return{x:point.x*Math.cos(angle)-point.y*Math.sin(angle),y:point.x*Math.sin(angle)+point.y*Math.cos(angle)}}static transform2NewAxis(point,angleFromOriginalAxis2DestAxis){return{x:point.x*Math.cos(angleFromOriginalAxis2DestAxis)+point.y*Math.sin(angleFromOriginalAxis2DestAxis),y:-point.x*Math.sin(angleFromOriginalAxis2DestAxis)+point.y*Math.cos(angleFromOriginalAxis2DestAxis)}}static angleFromA2B(a,b){return Math.atan2(a.x*b.y-a.y*b.x,a.x*b.x+a.y*b.y)}static transformPointWRTAnchor(point,anchor,angle){let newPoint=this.rotatePoint(this.subVector(point,anchor),angle);return this.addVector(newPoint,anchor)}static distanceBetweenPoints(a,b){return this.magnitude(this.subVector(a,b))}static flipYAxis(point){return{x:point.x,y:-point.y,z:point.z}}static linearInterpolation(a,b,t){return null==a.z||null==b.z?{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t}:{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t,z:a.z+(b.z-a.z)*t}}static isEqual(a,b){return null==a.z&&(a.z=0),null==b.z&&(b.z=0),a.x==b.x&&a.y==b.y&&a.z==b.z}static getLineIntersection(startPoint,endPoint,startPoint2,endPoint2){const numerator=(endPoint2.x-startPoint2.x)*(startPoint.y-startPoint2.y)-(endPoint2.y-startPoint2.y)*(startPoint.x-startPoint2.x),denominator=(endPoint2.y-startPoint2.y)*(endPoint.x-startPoint.x)-(endPoint2.x-startPoint2.x)*(endPoint.y-startPoint.y);if(0===denominator)return{intersects:!1};const t=numerator/denominator;return t>=0&&t<=1?{intersects:!0,intersection:PointCal.linearInterpolation(startPoint,endPoint,t),offset:t}:{intersects:!1}}}function convert2WorldSpaceWRT(targetPosition,interestPoint,viewPortWidth,viewPortHeight,cameraZoomLevel,cameraRotation){let cameraFrameCenter={x:viewPortWidth/2,y:viewPortHeight/2},delta2Point=PointCal.subVector(interestPoint,cameraFrameCenter);return delta2Point=PointCal.multiplyVectorByScalar(delta2Point,1/cameraZoomLevel),delta2Point=PointCal.rotatePoint(delta2Point,cameraRotation),PointCal.addVector(targetPosition,delta2Point)}function convert2WorldSpace(point,viewPortWidth,viewPortHeight,cameraPosition,cameraZoomLevel,cameraRotation){let cameraFrameCenter={x:viewPortWidth/2,y:viewPortHeight/2},delta2Point=PointCal.subVector(point,cameraFrameCenter);return delta2Point=PointCal.multiplyVectorByScalar(delta2Point,1/cameraZoomLevel),delta2Point=PointCal.rotatePoint(delta2Point,cameraRotation),PointCal.addVector(cameraPosition,delta2Point)}function withinBoundaries(point,boundaries){if(null==boundaries)return!0;let leftSide=!1,rightSide=!1,topSide=!1,bottomSide=!1;return(null==boundaries.max||null==boundaries.max.x||point.x<=boundaries.max.x)&&(rightSide=!0),(null==boundaries.min||null==boundaries.min.x||point.x>=boundaries.min.x)&&(leftSide=!0),(null==boundaries.max||null==boundaries.max.y||point.y<=boundaries.max.y)&&(topSide=!0),(null==boundaries.min||null==boundaries.min.y||point.y>=boundaries.min.y)&&(bottomSide=!0),leftSide&&rightSide&&topSide&&bottomSide}function boundariesFullyDefined(boundaries){return null!=boundaries&&(null!=boundaries.max&&null!=boundaries.min&&(null!=boundaries.max.x&&null!=boundaries.max.y&&null!=boundaries.min.x&&null!=boundaries.min.y))}function clampPoint(point,boundaries){if(withinBoundaries(point,boundaries)||null==boundaries)return point;let manipulatePoint={x:point.x,y:point.y},limit=boundaries.min;return null!=limit&&(null!=limit.x&&(manipulatePoint.x=Math.max(manipulatePoint.x,limit.x)),null!=limit.y&&(manipulatePoint.y=Math.max(manipulatePoint.y,limit.y))),limit=boundaries.max,null!=limit&&(null!=limit.x&&(manipulatePoint.x=Math.min(manipulatePoint.x,limit.x)),null!=limit.y&&(manipulatePoint.y=Math.min(manipulatePoint.y,limit.y))),manipulatePoint}function translationWidthOf(boundaries){if(null!=boundaries&&null!=boundaries.min&&null!=boundaries.max&&null!=boundaries.min.x&&null!=boundaries.max.x)return boundaries.max.x-boundaries.min.x}function translationHeightOf(boundaries){if(null!=boundaries&&null!=boundaries.min&&null!=boundaries.max&&null!=boundaries.min.y&&null!=boundaries.max.y)return boundaries.max.y-boundaries.min.y}function clampPointEntireViewPort(point,viewPortWidth,viewPortHeight,boundaries,cameraZoomLevel,cameraRotation){if(null==boundaries)return point;let topLeftCorner=convert2WorldSpaceWRT(point,{x:0,y:viewPortHeight},viewPortWidth,viewPortHeight,cameraZoomLevel,cameraRotation),bottomLeftCorner=convert2WorldSpaceWRT(point,{x:0,y:0},viewPortWidth,viewPortHeight,cameraZoomLevel,cameraRotation),topRightCorner=convert2WorldSpaceWRT(point,{x:viewPortWidth,y:viewPortHeight},viewPortWidth,viewPortHeight,cameraZoomLevel,cameraRotation),bottomRightCorner=convert2WorldSpaceWRT(point,{x:viewPortWidth,y:0},viewPortWidth,viewPortHeight,cameraZoomLevel,cameraRotation),topLeftCornerClamped=clampPoint(topLeftCorner,boundaries),topRightCornerClamped=clampPoint(topRightCorner,boundaries),bottomLeftCornerClamped=clampPoint(bottomLeftCorner,boundaries),bottomRightCornerClamped=clampPoint(bottomRightCorner,boundaries),diffs=[PointCal.subVector(topLeftCornerClamped,topLeftCorner),PointCal.subVector(topRightCornerClamped,topRightCorner),PointCal.subVector(bottomLeftCornerClamped,bottomLeftCorner),PointCal.subVector(bottomRightCornerClamped,bottomRightCorner)],maxXDiff=Math.abs(diffs[0].x),maxYDiff=Math.abs(diffs[0].y),delta=diffs[0];return diffs.forEach((diff=>{Math.abs(diff.x)>maxXDiff&&(maxXDiff=Math.abs(diff.x),delta.x=diff.x),Math.abs(diff.y)>maxYDiff&&(maxYDiff=Math.abs(diff.y),delta.y=diff.y)})),PointCal.addVector(point,delta)}function clampRotation(rotation,rotationLimits){if(rotationWithinLimits(rotation,rotationLimits)||void 0===rotationLimits)return rotation;rotation=normalizeAngleZero2TwoPI(rotation);const angleSpanFromStart=angleSpan(rotationLimits.start,rotation),angleSpanFromEnd=angleSpan(rotationLimits.end,rotation);if(rotationLimits.ccw&&(angleSpanFromStart<0||angleSpanFromEnd>0)||!rotationLimits.ccw&&(angleSpanFromStart>0||angleSpanFromEnd<0)){if(Math.abs(angleSpanFromStart)===Math.abs(angleSpanFromEnd))return rotationLimits.startAsTieBreaker?rotationLimits.start:rotationLimits.end;return Math.abs(angleSpanFromStart)<Math.abs(angleSpanFromEnd)?rotationLimits.start:rotationLimits.end}return rotation}function rotationWithinLimits(rotation,rotationLimits){if(void 0===rotationLimits)return!0;const angleSpanFromStart=angleSpan(rotationLimits.start,rotation),angleSpanFromEnd=angleSpan(rotationLimits.end,rotation);return!(rotationLimits.ccw&&(angleSpanFromStart<0||angleSpanFromEnd>0)||!rotationLimits.ccw&&(angleSpanFromStart>0||angleSpanFromEnd<0))}function normalizeAngleZero2TwoPI(angle){return angle=((angle%=2*Math.PI)+2*Math.PI)%(2*Math.PI)}function angleSpan(from,to){from=normalizeAngleZero2TwoPI(from);let angleDiff=(to=normalizeAngleZero2TwoPI(to))-from;return angleDiff>Math.PI&&(angleDiff=-(2*Math.PI-angleDiff)),angleDiff<-Math.PI&&(angleDiff+=2*Math.PI),angleDiff}class PanHandlerBoilerPlate{constructor(nextHandler=void 0){this._nextHandler=nextHandler}set nextHandler(handler){this._nextHandler=handler}get nextHandler(){return this._nextHandler}chainHandler(handler){return this._nextHandler=handler,handler}panCameraTo(camera,destination){this._nextHandler&&this._nextHandler.panCameraTo(camera,destination)}panCameraBy(camera,delta){this._nextHandler&&this._nextHandler.panCameraBy(camera,delta)}}class BasePanHandler extends PanHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler)}panCameraTo(camera,destination){camera.setPosition(destination)}panCameraBy(camera,diff){camera.setPosition(PointCal.addVector(camera.position,diff))}}class ClampHandler extends PanHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler),this._entireViewPort=!1}set entireViewPort(entireViewPort){this._entireViewPort=entireViewPort}get entireViewPort(){return this._entireViewPort}panCameraTo(camera,destination){let actualDest=clampPoint(destination,camera.boundaries);this._entireViewPort&&(actualDest=clampPointEntireViewPort(destination,camera.viewPortWidth,camera.viewPortHeight,camera.boundaries,camera.zoomLevel,camera.rotation)),super.panCameraTo(camera,actualDest)}panCameraBy(camera,delta){let actualDelta=PointCal.subVector(clampPoint(PointCal.addVector(camera.position,delta),camera.boundaries),camera.position);this._entireViewPort&&(actualDelta=PointCal.subVector(clampPointEntireViewPort(PointCal.addVector(camera.position,delta),camera.viewPortWidth,camera.viewPortHeight,camera.boundaries,camera.zoomLevel,camera.rotation),camera.position)),super.panCameraBy(camera,actualDelta)}}class PanWithRestriction extends PanHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler),this._restrictXTranslation=!1,this._restrictYTranslation=!1,this._restrictRelativeXTranslation=!1,this._restrictRelativeYTranslation=!1}set restrictXTranslation(restrictXTranslation){this._restrictXTranslation=restrictXTranslation}get restrictXTranslation(){return this._restrictXTranslation}set restrictYTranslation(restrictYTranslation){this._restrictYTranslation=restrictYTranslation}get restrictYTranslation(){return this._restrictYTranslation}set restrictRelativeXTranslation(restrictRelativeXTranslation){this._restrictRelativeXTranslation=restrictRelativeXTranslation}get restrictRelativeXTranslation(){return this._restrictRelativeXTranslation}set restrictRelativeYTranslation(restrictRelativeYTranslation){this._restrictRelativeYTranslation=restrictRelativeYTranslation}get restrictRelativeYTranslation(){return this._restrictRelativeYTranslation}convertDeltaToComplyWithRestriction(camera,delta){if(this._restrictXTranslation&&this._restrictYTranslation)return{x:0,y:0};if(this._restrictRelativeXTranslation&&this._restrictRelativeYTranslation)return{x:0,y:0};if(this._restrictXTranslation&&(delta.x=0),this._restrictYTranslation&&(delta.y=0),this._restrictRelativeXTranslation){const upDirection=PointCal.rotatePoint({x:0,y:1},camera.rotation),value=PointCal.dotProduct(upDirection,delta);delta=PointCal.multiplyVectorByScalar(upDirection,value)}if(this._restrictRelativeYTranslation){const rightDirection=PointCal.rotatePoint({x:1,y:0},camera.rotation),value=PointCal.dotProduct(rightDirection,delta);delta=PointCal.multiplyVectorByScalar(rightDirection,value)}return delta}panCameraTo(camera,destination){let delta=PointCal.subVector(destination,camera.position);if(delta=this.convertDeltaToComplyWithRestriction(camera,delta),0===delta.x&&0===delta.y)return;const dest=PointCal.addVector(camera.position,delta);super.panCameraTo(camera,dest)}panCameraBy(camera,delta){delta=this.convertDeltaToComplyWithRestriction(camera,delta),super.panCameraBy(camera,delta)}}class PanRig extends PanHandlerBoilerPlate{set restrictRelativeXTranslation(restrictRelativeXTranslation){this.restrictionHandler.restrictRelativeXTranslation=restrictRelativeXTranslation}set restrictRelativeYTranslation(restrictRelativeYTranslation){this.restrictionHandler.restrictRelativeYTranslation=restrictRelativeYTranslation}set restrictXTranslation(restrictXTranslation){this.restrictionHandler.restrictXTranslation=restrictXTranslation}set restrictYTranslation(restrictYTranslation){this.restrictionHandler.restrictYTranslation=restrictYTranslation}set restrictTranslation(restrictTranslation){this.restrictionHandler.restrictXTranslation=restrictTranslation,this.restrictionHandler.restrictYTranslation=restrictTranslation}get restrictTranslation(){return this.restrictionHandler.restrictXTranslation}get restrictXTranslation(){return this.restrictionHandler.restrictXTranslation}get restrictYTranslation(){return this.restrictionHandler.restrictYTranslation}get restrictRelativeXTranslation(){return this.restrictionHandler.restrictRelativeXTranslation}get restrictRelativeYTranslation(){return this.restrictionHandler.restrictRelativeYTranslation}set limitEntireViewPort(limitEntireViewPort){this.clampHandler.entireViewPort=limitEntireViewPort}get limitEntireViewPort(){return this.clampHandler.entireViewPort}constructor(){super(),this.baseHandler=new BasePanHandler,this.clampHandler=new ClampHandler,this.restrictionHandler=new PanWithRestriction,this.restrictionHandler.chainHandler(this.clampHandler).chainHandler(this.baseHandler),this.nextHandler=this.restrictionHandler}}class RotationHandlerBoilerPlate{constructor(nextHandler=void 0){this._nextHandler=nextHandler}set nextHandler(handler){this._nextHandler=handler}get nextHandler(){return this._nextHandler}chainHandler(handler){return this._nextHandler=handler,handler}rotateCameraTo(camera,targetRotation){this._nextHandler&&this._nextHandler.rotateCameraTo(camera,targetRotation)}rotateCameraBy(camera,delta){this._nextHandler&&this._nextHandler.rotateCameraBy(camera,delta)}}class BaseRotationHandler extends RotationHandlerBoilerPlate{constructor(nextHandler=void 0){super()}rotateCameraTo(camera,targetRotation){targetRotation=normalizeAngleZero2TwoPI(targetRotation),camera.setRotation(targetRotation)}rotateCameraBy(camera,diff){const curRotation=camera.rotation,targetRotation=normalizeAngleZero2TwoPI(curRotation+diff);diff=angleSpan(curRotation,targetRotation),camera.setRotation(targetRotation)}}class RotationRestrictionHandler extends RotationHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler),this._restrictRotation=!1}get restrictRotation(){return this._restrictRotation}set restrictRotation(restrictRotation){this._restrictRotation=restrictRotation}rotateCameraBy(camera,diff){this._restrictRotation||super.rotateCameraBy(camera,diff)}rotateCameraTo(camera,targetRotation){this._restrictRotation||super.rotateCameraTo(camera,targetRotation)}}class RotationClampHandler extends RotationHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler)}rotateCameraBy(camera,diff){const curRotation=camera.rotation;let targetRotation=normalizeAngleZero2TwoPI(curRotation+diff);targetRotation=clampRotation(targetRotation,camera.rotationBoundaries),diff=angleSpan(curRotation,targetRotation),super.rotateCameraBy(camera,diff)}rotateCameraTo(camera,targetRotation){targetRotation=clampRotation(targetRotation=normalizeAngleZero2TwoPI(targetRotation),camera.rotationBoundaries),super.rotateCameraTo(camera,targetRotation)}}class RotationRig extends RotationHandlerBoilerPlate{get restrictRotation(){return this._restrictionHandler.restrictRotation}set restrictRotation(restrictRotation){this._restrictionHandler.restrictRotation=restrictRotation}constructor(nextHandler=void 0){super(nextHandler),this._baseHandler=new BaseRotationHandler,this._clampHandler=new RotationClampHandler(this._baseHandler),this._restrictionHandler=new RotationRestrictionHandler(this._clampHandler)}rotateCameraBy(camera,diff){this._restrictionHandler.rotateCameraBy(camera,diff),super.rotateCameraBy(camera,diff)}rotateCameraTo(camera,targetRotation){this._restrictionHandler.rotateCameraTo(camera,targetRotation),super.rotateCameraTo(camera,targetRotation)}}class ZoomHandlerBoilerPlate{constructor(nextHandler=void 0){this._nextHandler=nextHandler}set nextHandler(handler){this._nextHandler=handler}get nextHandler(){return this._nextHandler}chainHandler(handler){return this._nextHandler=handler,handler}zoomCameraTo(camera,targetZoom){this._nextHandler&&this._nextHandler.zoomCameraTo(camera,targetZoom)}zoomCameraBy(camera,delta){this._nextHandler&&this._nextHandler.zoomCameraBy(camera,delta)}zoomCameraToAt(camera,to,at){this._nextHandler&&this._nextHandler.zoomCameraToAt(camera,to,at)}zoomCameraByAt(camera,delta,at){this._nextHandler&&this._nextHandler.zoomCameraByAt(camera,delta,at)}}class BaseZoomHandler extends ZoomHandlerBoilerPlate{constructor(panHandler,nextHandler=void 0){super(nextHandler),this.panHandler=panHandler}set nextHandler(handler){this._nextHandler=void 0}zoomCameraTo(camera,targetZoom){camera.setZoomLevel(targetZoom)}zoomCameraBy(camera,diff){const targetZoom=camera.zoomLevel+diff;camera.setZoomLevel(targetZoom)}zoomCameraToAt(camera,to,at){let originalAnchorInWorld=convert2WorldSpace(at,camera.viewPortWidth,camera.viewPortHeight,camera.position,camera.zoomLevel,camera.rotation);camera.zoomLevel,camera.setZoomLevel(to);let anchorInWorldAfterZoom=convert2WorldSpace(at,camera.viewPortWidth,camera.viewPortHeight,camera.position,camera.zoomLevel,camera.rotation);const diff=PointCal.subVector(originalAnchorInWorld,anchorInWorldAfterZoom);this.panHandler.panCameraBy(camera,diff)}zoomCameraByAt(camera,delta,at){let originalAnchorInWorld=convert2WorldSpace(at,camera.viewPortWidth,camera.viewPortHeight,camera.position,camera.zoomLevel,camera.rotation);const targetZoom=camera.zoomLevel+delta;camera.setZoomLevel(targetZoom);let anchorInWorldAfterZoom=convert2WorldSpace(at,camera.viewPortWidth,camera.viewPortHeight,camera.position,camera.zoomLevel,camera.rotation);const diff=PointCal.subVector(originalAnchorInWorld,anchorInWorldAfterZoom);this.panHandler.panCameraBy(camera,diff)}}class ZoomClampHandler extends ZoomHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler)}zoomCameraTo(camera,targetZoom){targetZoom=clampZoomLevel(targetZoom,camera.zoomBoundaries),super.zoomCameraTo(camera,targetZoom)}zoomCameraBy(camera,diff){let targetZoom=camera.zoomLevel+diff;targetZoom=clampZoomLevel(targetZoom,camera.zoomBoundaries),diff=targetZoom-camera.zoomLevel,super.zoomCameraBy(camera,diff)}zoomCameraToAt(camera,to,at){to=clampZoomLevel(to,camera.zoomBoundaries),super.zoomCameraToAt(camera,to,at)}zoomByAt(camera,delta,at){let targetZoom=camera.zoomLevel+delta;targetZoom=clampZoomLevel(targetZoom,camera.zoomBoundaries),delta=targetZoom-camera.zoomLevel,super.zoomCameraByAt(camera,delta,at)}}class ZoomRestrictionHandler extends ZoomHandlerBoilerPlate{constructor(nextHandler=void 0){super(nextHandler),this._restrictZoom=!1}set restrictZoom(restrictZoom){this._restrictZoom=restrictZoom}get restrictZoom(){return this._restrictZoom}zoomCameraTo(camera,targetZoom){this._restrictZoom||super.zoomCameraTo(camera,targetZoom)}zoomCameraBy(camera,diff){this._restrictZoom||super.zoomCameraBy(camera,diff)}zoomCameraToAt(camera,to,at){this._restrictZoom||super.zoomCameraToAt(camera,to,at)}zoomCameraByAt(camera,delta,at){this._restrictZoom||super.zoomCameraByAt(camera,delta,at)}}class ZoomRig extends ZoomHandlerBoilerPlate{constructor(basePanHandler,nextHandler=void 0){super(nextHandler),this._baseHandler=new BaseZoomHandler(basePanHandler),this._clampHandler=new ZoomClampHandler,this._restrictionHandler=new ZoomRestrictionHandler,this._restrictionHandler.chainHandler(this._clampHandler).chainHandler(this._baseHandler),this._nextHandler=this._restrictionHandler}set restrictZoom(restrict){this._restrictionHandler.restrictZoom=restrict}get restrictZoom(){return this._restrictionHandler.restrictZoom}zoomCameraTo(camera,targetZoom){super.zoomCameraTo(camera,targetZoom)}zoomCameraBy(camera,delta){super.zoomCameraBy(camera,delta)}zoomCameraByAt(camera,delta,at){super.zoomCameraByAt(camera,delta,at)}zoomCameraToAt(camera,to,at){super.zoomCameraToAt(camera,to,at)}}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}\"function\"==typeof SuppressedError&&SuppressedError;class CameraObserverV2{constructor(){this.panCallbackList=[],this.zoomCallbackList=[],this.rotateCallbackList=[]}notifyPositionChange(delta,cameraState){return __awaiter(this,void 0,void 0,(function*(){queueMicrotask((()=>{this.panCallbackList.forEach((callback=>{callback({diff:delta},cameraState)}))}))}))}notifyZoomChange(deltaZoomAmount,cameraState){return __awaiter(this,void 0,void 0,(function*(){return new Promise(((resolve,reject)=>{this.zoomCallbackList.forEach((callback=>{callback({deltaZoomAmount:deltaZoomAmount},cameraState)})),resolve()}))}))}notifyRotationChange(deltaRotation,cameraState){return __awaiter(this,void 0,void 0,(function*(){return new Promise(((resolve,reject)=>{this.rotateCallbackList.forEach((callback=>{callback({deltaRotation:deltaRotation},cameraState)})),resolve()}))}))}on(eventName,callback){switch(eventName){case\"pan\":return this.panCallbackList.push(callback),()=>{this.panCallbackList=this.panCallbackList.filter((cb=>cb!==callback))};case\"zoom\":return this.zoomCallbackList.push(callback),()=>{this.zoomCallbackList=this.zoomCallbackList.filter((cb=>cb!==callback))};case\"rotate\":return this.rotateCallbackList.push(callback),()=>{this.rotateCallbackList=this.rotateCallbackList.filter((cb=>cb!==callback))}}return()=>{}}clearCallbacks(){this.panCallbackList=[],this.zoomCallbackList=[],this.rotateCallbackList=[]}}class BoardCameraV2{constructor(cameraObserver=new CameraObserverV2,position={x:0,y:0},viewPortWidth=1e3,viewPortHeight=1e3,zoomLevel=1,rotation=0){this._position=position,this._zoomLevel=zoomLevel,this._rotation=rotation,this._viewPortHeight=viewPortHeight,this._viewPortWidth=viewPortWidth,this._observer=cameraObserver}get boundaries(){return this._boundaries}set boundaries(boundaries){this._boundaries=boundaries}get viewPortWidth(){return this._viewPortWidth}set viewPortWidth(width){this._viewPortWidth=width}get viewPortHeight(){return this._viewPortHeight}set viewPortHeight(height){this._viewPortHeight=height}get position(){return this._position}get observer(){return this._observer}setPosition(destination){if(withinBoundaries(destination,this._boundaries)){const diff=PointCal.subVector(destination,this._position);if(PointCal.magnitude(diff)<1e-9&&PointCal.magnitude(diff)<1/this._zoomLevel)return;this._position=destination,this._observer.notifyPositionChange(diff,{position:this._position,rotation:this._rotation,zoomLevel:this._zoomLevel})}}get zoomLevel(){return this._zoomLevel}get zoomBoundaries(){return this._zoomBoundaries}set zoomBoundaries(zoomBoundaries){if(void 0!==zoomBoundaries&&void 0!==zoomBoundaries.min&&void 0!==zoomBoundaries.max&&zoomBoundaries.min>zoomBoundaries.max){let temp=zoomBoundaries.max;zoomBoundaries.max=zoomBoundaries.min,zoomBoundaries.min=temp}this._zoomBoundaries=zoomBoundaries}setMaxZoomLevel(maxZoomLevel){return null==this._zoomBoundaries&&(this._zoomBoundaries={min:void 0,max:void 0}),!(null!=this._zoomBoundaries.min&&this._zoomBoundaries.min>maxZoomLevel||this._zoomLevel>maxZoomLevel)&&(this._zoomBoundaries.max=maxZoomLevel,!0)}setMinZoomLevel(minZoomLevel){return null==this._zoomBoundaries&&(this._zoomBoundaries={min:void 0,max:void 0}),!(null!=this._zoomBoundaries.max&&this._zoomBoundaries.max<minZoomLevel)&&(this._zoomBoundaries.min=minZoomLevel,this._zoomLevel<minZoomLevel&&(this._zoomLevel=minZoomLevel),!0)}setZoomLevel(zoomLevel){if(zoomLevelWithinLimits(zoomLevel,this._zoomBoundaries)){if(void 0!==this._zoomBoundaries&&void 0!==this._zoomBoundaries.max&&clampZoomLevel(zoomLevel,this._zoomBoundaries)==this._zoomBoundaries.max&&this._zoomLevel==this._zoomBoundaries.max)return;if(void 0!==this._zoomBoundaries&&void 0!==this._zoomBoundaries.min&&clampZoomLevel(zoomLevel,this._zoomBoundaries)==this._zoomBoundaries.min&&this._zoomLevel==this._zoomBoundaries.min)return;const curZoom=this._zoomLevel;this._zoomLevel=zoomLevel,this._observer.notifyZoomChange(this._zoomLevel-curZoom,{position:this._position,rotation:this._rotation,zoomLevel:this._zoomLevel})}}get rotation(){return this._rotation}get rotationBoundaries(){return this._rotationBoundaries}set rotationBoundaries(rotationBoundaries){if(void 0!==rotationBoundaries&&void 0!==rotationBoundaries.start&&void 0!==rotationBoundaries.end&&rotationBoundaries.start>rotationBoundaries.end){let temp=rotationBoundaries.end;rotationBoundaries.end=rotationBoundaries.start,rotationBoundaries.start=temp}this._rotationBoundaries=rotationBoundaries}setRotation(rotation){if(rotationWithinLimits(rotation,this._rotationBoundaries)){if(rotation=normalizeAngleZero2TwoPI(rotation),void 0!==this._rotationBoundaries&&void 0!==this._rotationBoundaries.end&&clampRotation(rotation,this._rotationBoundaries)==this._rotationBoundaries.end&&this._rotation==this._rotationBoundaries.end)return;if(void 0!==this._rotationBoundaries&&void 0!==this.rotationBoundaries.start&&clampRotation(rotation,this._rotationBoundaries)==this._rotationBoundaries.start&&this._rotation==this._rotationBoundaries.start)return;this._observer.notifyRotationChange(rotation-this._rotation,{position:this._position,rotation:rotation,zoomLevel:this._zoomLevel}),this._rotation=rotation}}convertFromViewPort2WorldSpace(point){return convert2WorldSpace(point,this._viewPortWidth,this._viewPortHeight,this._position,this._zoomLevel,this._rotation)}invertFromWorldSpace2ViewPort(point){let cameraFrameCenter={x:this.viewPortWidth/2,y:this._viewPortHeight/2},delta2Point=PointCal.subVector(point,this._position);return delta2Point=PointCal.rotatePoint(delta2Point,-this._rotation),delta2Point=PointCal.multiplyVectorByScalar(delta2Point,this._zoomLevel),PointCal.addVector(cameraFrameCenter,delta2Point)}setHorizontalBoundaries(min,max){if(min>max){let temp=max;max=min,min=temp}null==this._boundaries&&(this._boundaries={min:{x:void 0,y:void 0},max:{x:void 0,y:void 0}}),this._boundaries.min.x=min,this._boundaries.max.x=max}setVerticalBoundaries(min,max){if(min>max){let temp=max;max=min,min=temp}null==this._boundaries&&(this._boundaries={min:{x:void 0,y:void 0},max:{x:void 0,y:void 0}}),this._boundaries.min.y=min,this._boundaries.max.y=max}on(eventName,callback){return this._observer.on(eventName,callback)}}class DefaultBoardKMTStrategy{constructor(canvas,camera,inputObserver,debugMode=!1,alignCoordinateSystem=!0){this._panDisabled=!1,this._zoomDisabled=!1,this._rotateDisabled=!1,this._keyController=new Map,this.SCROLL_SENSATIVITY=.005,this.isDragging=!1,this._canvas=canvas,this._camera=camera,this._debugMode=debugMode,this._alignCoordinateSystem=alignCoordinateSystem,this.bindFunctions(),this.inputObserver=inputObserver}get debugMode(){return this._debugMode}set debugMode(value){this._debugMode=value}get alignCoordinateSystem(){return this._alignCoordinateSystem}set alignCoordinateSystem(value){this._alignCoordinateSystem=value}get panDisabled(){return this._panDisabled}set panDisabled(value){this._panDisabled=value,value&&(this.canvas.style.cursor=\"auto\",this.isDragging=!1,this.dragStartPoint={x:0,y:0})}get zoomDisabled(){return this._zoomDisabled}set zoomDisabled(value){this._zoomDisabled=value}get rotateDisabled(){return this._rotateDisabled}set rotateDisabled(value){this._rotateDisabled=value}get camera(){return this._camera}set camera(value){this._camera=value}get canvas(){return this._canvas}setUp(){this.canvas.addEventListener(\"pointerdown\",this.pointerDownHandler),this.canvas.addEventListener(\"pointerup\",this.pointerUpHandler),this.canvas.addEventListener(\"pointermove\",this.pointerMoveHandler),this.canvas.addEventListener(\"wheel\",this.scrollHandler),window.addEventListener(\"keydown\",this.keypressHandler),window.addEventListener(\"keyup\",this.keyupHandler),this.setupKeyController([\" \"])}tearDown(){this.canvas.removeEventListener(\"pointerdown\",this.pointerDownHandler),this.canvas.removeEventListener(\"pointerup\",this.pointerUpHandler),this.canvas.removeEventListener(\"pointermove\",this.pointerMoveHandler),this.canvas.removeEventListener(\"wheel\",this.scrollHandler),window.removeEventListener(\"keydown\",this.keypressHandler),window.removeEventListener(\"keyup\",this.keyupHandler)}bindFunctions(){this.pointerDownHandler=this.pointerDownHandler.bind(this),this.pointerUpHandler=this.pointerUpHandler.bind(this),this.pointerMoveHandler=this.pointerMoveHandler.bind(this),this.scrollHandler=this.scrollHandler.bind(this),this.keypressHandler=this.keypressHandler.bind(this),this.keyupHandler=this.keyupHandler.bind(this)}setupKeyController(keys){keys.forEach((key=>{this._keyController.set(key,!1)}))}pointerDownHandler(e){this._disabled||\"mouse\"!==e.pointerType||1!=e.button&&!e.metaKey&&!this._keyController.get(\" \")||this._panDisabled||(this.isDragging=!0,this.dragStartPoint={x:e.clientX,y:e.clientY})}disableStrategy(){this.isDragging=!1,this.dragStartPoint={x:0,y:0},this._disabled=!0}enableStrategy(){this._disabled=!1}pointerUpHandler(e){this._disabled||\"mouse\"===e.pointerType&&(this.isDragging&&(this.isDragging=!1),this._debugMode?this.canvas.style.cursor=\"none\":this.canvas.style.cursor=\"auto\")}pointerMoveHandler(e){if(!this._disabled&&\"mouse\"==e.pointerType&&this.isDragging&&!this._panDisabled){this._debugMode?this.canvas.style.cursor=\"none\":this.canvas.style.cursor=\"grabbing\";const target={x:e.clientX,y:e.clientY};let diff=PointCal.subVector(this.dragStartPoint,target);this._alignCoordinateSystem||(diff=PointCal.flipYAxis(diff));let diffInWorld=PointCal.rotatePoint(diff,this._camera.rotation);diffInWorld=PointCal.multiplyVectorByScalar(diffInWorld,1/this._camera.zoomLevel),this.inputObserver.notifyOnPan(this._camera,diffInWorld),this.dragStartPoint=target}}scrollHandler(e){if(this._disabled)return;e.preventDefault();const zoomAmount=e.deltaY*this.SCROLL_SENSATIVITY;if(e.ctrlKey){if(this._zoomDisabled)return;const cursorPosition={x:e.clientX,y:e.clientY};let anchorPoint=PointCal.subVector(cursorPosition,{x:this.canvas.getBoundingClientRect().left,y:this.canvas.getBoundingClientRect().top});this._alignCoordinateSystem||(anchorPoint=PointCal.subVector(cursorPosition,{x:this.canvas.getBoundingClientRect().left,y:this.canvas.getBoundingClientRect().bottom}),anchorPoint=PointCal.flipYAxis(anchorPoint)),this.inputObserver.notifyOnZoom(this._camera,-this._camera.zoomLevel*zoomAmount*5,anchorPoint)}else{if(this._panDisabled)return;let diff={x:e.deltaX,y:e.deltaY};this._alignCoordinateSystem||(diff=PointCal.flipYAxis(diff));let diffInWorld=PointCal.rotatePoint(diff,this._camera.rotation);diffInWorld=PointCal.multiplyVectorByScalar(diffInWorld,1/this._camera.zoomLevel),this.inputObserver.notifyOnPan(this._camera,diffInWorld)}}keypressHandler(e){this._keyController.has(e.key)&&0==this._keyController.get(e.key)&&(e.preventDefault(),this._keyController.set(e.key,!0))}keyupHandler(e){this._keyController.has(e.key)&&1==this._keyController.get(e.key)&&(e.preventDefault(),this._keyController.set(e.key,!1),this.isDragging=!1,this.canvas.style.cursor=\"auto\")}updateCamera(camera){this._camera=camera}get disabled(){return this._disabled}}class DefaultTouchStrategy{constructor(canvas,controlCamera,inputObserver,alignCoordinateSystem=!0){this._panDisabled=!1,this._zoomDisabled=!1,this._rotateDisabled=!1,this.isDragging=!1,this.ZOOM_SENSATIVITY=.005,this.panInputCallBackList=[],this.zoomInputCallBackList=[],this.controlCamera=controlCamera,this.canvas=canvas,this._disabled=!1,this.touchPoints=[],this.zoomStartDist=0,this.isDragging=!1,this.dragStartPoint={x:0,y:0},this._alignCoordinateSystem=alignCoordinateSystem,this.inputObserver=inputObserver,this.bindListeners()}bindListeners(){this.touchstartHandler=this.touchstartHandler.bind(this),this.touchendHandler=this.touchendHandler.bind(this),this.touchcancelHandler=this.touchcancelHandler.bind(this),this.touchmoveHandler=this.touchmoveHandler.bind(this)}resetAttributes(){this.touchPoints=[],this.zoomStartDist=0,this.isDragging=!1,this.dragStartPoint=null,this.tapPoint=null}enableStrategy(){this._disabled=!1}disableStrategy(){this.resetAttributes(),this._disabled=!0}setUp(){this.canvas.addEventListener(\"touchstart\",this.touchstartHandler),this.canvas.addEventListener(\"touchend\",this.touchendHandler),this.canvas.addEventListener(\"touchcancel\",this.touchcancelHandler),this.canvas.addEventListener(\"touchmove\",this.touchmoveHandler)}tearDown(){this.resetAttributes(),this.canvas.removeEventListener(\"touchstart\",this.touchstartHandler),this.canvas.removeEventListener(\"touchend\",this.touchendHandler),this.canvas.removeEventListener(\"touchcancel\",this.touchcancelHandler),this.canvas.removeEventListener(\"touchmove\",this.touchmoveHandler)}get disabled(){return this._disabled}get alignCoordinateSystem(){return this._alignCoordinateSystem}set alignCoordinateSystem(alignCoordinateSystem){this._alignCoordinateSystem=alignCoordinateSystem}get panDisabled(){return this._panDisabled}set panDisabled(panDisabled){this._panDisabled=panDisabled}get zoomDisabled(){return this._zoomDisabled}set zoomDisabled(zoomDisabled){this._zoomDisabled=zoomDisabled}get rotateDisabled(){return this._rotateDisabled}set rotateDisabled(rotateDisabled){this._rotateDisabled=rotateDisabled}get camera(){return this.controlCamera}set camera(camera){this.controlCamera=camera}updateCamera(camera){this.controlCamera=camera}touchstartHandler(e){if(!this._disabled)if(e.preventDefault(),2===e.targetTouches.length){this.isDragging=!1;let firstTouchPoint={x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY},secondTouchPoint={x:e.targetTouches[1].clientX,y:e.targetTouches[1].clientY};this.zoomStartDist=PointCal.distanceBetweenPoints(firstTouchPoint,secondTouchPoint),this.touchPoints=[firstTouchPoint,secondTouchPoint]}else 1===e.targetTouches.length&&(this.tapPoint={x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY},this.tapPoint=this.controlCamera.convertFromViewPort2WorldSpace(this.convertWindowPoint2ViewPortPoint({x:this.canvas.getBoundingClientRect().left,y:this.canvas.getBoundingClientRect().top},this.tapPoint)),this.isDragging=!0,this.dragStartPoint={x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY})}touchcancelHandler(e){this._disabled||(this.isDragging=!1,this.touchPoints=[])}touchendHandler(e){this._disabled||(this.isDragging=!1,this.touchPoints=[])}touchmoveHandler(e){if(!this._disabled)if(e.preventDefault(),2==e.targetTouches.length&&2==this.touchPoints.length){if(this._zoomDisabled)return;let startPoint={x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY},endPoint={x:e.targetTouches[1].clientX,y:e.targetTouches[1].clientY},touchPointDist=PointCal.distanceBetweenPoints(startPoint,endPoint),distDiff=this.zoomStartDist-touchPointDist,midPoint=PointCal.linearInterpolation(startPoint,endPoint,.5);midPoint=this._alignCoordinateSystem?this.convertWindowPoint2ViewPortPoint({x:this.canvas.getBoundingClientRect().left,y:this.canvas.getBoundingClientRect().top},midPoint):this.convertWindowPoint2ViewPortPoint({x:this.canvas.getBoundingClientRect().left,y:this.canvas.getBoundingClientRect().bottom},midPoint);let zoomAmount=.1*distDiff*this.controlCamera.zoomLevel*this.ZOOM_SENSATIVITY;this.inputObserver.notifyOnZoom(this.controlCamera,-zoomAmount,midPoint),this.touchPoints=[startPoint,endPoint],this.tapPoint=null}else if(1==e.targetTouches.length&&this.isDragging&&!this._panDisabled){let touchPoint={x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY},diff=PointCal.subVector(this.dragStartPoint,touchPoint);this._alignCoordinateSystem||(diff=PointCal.flipYAxis(diff));let diffInWorld=PointCal.rotatePoint(diff,this.controlCamera.rotation);diffInWorld=PointCal.multiplyVectorByScalar(diffInWorld,1/this.controlCamera.zoomLevel),this.inputObserver.notifyOnPan(this.controlCamera,diffInWorld),this.dragStartPoint=touchPoint,this.tapPoint=null}}convertWindowPoint2ViewPortPoint(bottomLeftCornerOfCanvas,clickPointInWindow){const res=PointCal.subVector(clickPointInWindow,bottomLeftCornerOfCanvas);return this._alignCoordinateSystem?{x:res.x,y:res.y}:{x:res.x,y:-res.y}}}function minZoomLevelBaseOnDimensions(boundaries,canvasWidth,canvasHeight,cameraRotation){const width=translationWidthOf(boundaries),height=translationHeightOf(boundaries);if(null==width||null==height)return;let minZoomLevelWidthWidth=canvasWidth/Math.abs(width*Math.cos(cameraRotation)),minZoomLevelHeightWidth=canvasWidth/Math.abs(height*Math.cos(cameraRotation)),minZoomLevelWidthHeight=canvasHeight/Math.abs(width*Math.sin(cameraRotation)),minZoomLevelHeightHeight=canvasHeight/Math.abs(height*Math.sin(cameraRotation));minZoomLevelWidthWidth==1/0&&(minZoomLevelWidthWidth=0),minZoomLevelHeightWidth==1/0&&(minZoomLevelHeightWidth=0),minZoomLevelWidthHeight==1/0&&(minZoomLevelWidthHeight=0),minZoomLevelHeightHeight==1/0&&(minZoomLevelHeightHeight=0);const minZoomLevelHeight=canvasHeight/height,minZoomLevelWidth=canvasWidth/width;return Math.max(minZoomLevelHeight,minZoomLevelWidth,minZoomLevelWidthWidth,minZoomLevelHeightWidth,minZoomLevelWidthHeight,minZoomLevelHeightHeight)}function zoomLevelBoundariesShouldUpdate(zoomLevelBoundaries,targetMinZoomLevel){return null!=targetMinZoomLevel&&(null==zoomLevelBoundaries||targetMinZoomLevel!=1/0&&(void 0!==zoomLevelBoundaries&&(null==zoomLevelBoundaries.min||targetMinZoomLevel>zoomLevelBoundaries.min)))}function minZoomLevelBaseOnWidth(boundaries,canvasWidth,canvasHeight,cameraRotation){const width=translationWidthOf(boundaries);if(null==width)return;const widthWidthProjection=Math.abs(width*Math.cos(cameraRotation)),widthHeightProjection=Math.abs(width*Math.sin(cameraRotation));if(canvasWidth/widthWidthProjection==1/0)return canvasHeight/widthHeightProjection;return Math.max(canvasWidth/widthWidthProjection,canvasHeight/widthHeightProjection)}function minZoomLevelBaseOnHeight(boundaries,canvasWidth,canvasHeight,cameraRotation){const height=translationHeightOf(boundaries);if(null==height)return;const minZoomLevelHeightWidth=canvasWidth/Math.abs(height*Math.cos(cameraRotation)),minZoomLevelHeightHeight=canvasHeight/Math.abs(height*Math.sin(cameraRotation));if(minZoomLevelHeightHeight==1/0)return minZoomLevelHeightWidth;return Math.max(minZoomLevelHeightWidth,minZoomLevelHeightHeight)}function calculateOrderOfMagnitude(value){if(value<=0)return 0;let count=0;if(value<1){let divisor=1;for(;divisor>value;)divisor/=10,count--}else{let divisor=1;for(;10*divisor<=value;)divisor*=10,count++}return count}function drawCrossHair(context,pos,cameraZoomLevel,alignCoordinateSystem,size,color=\"red\"){let halfSize=size/2;halfSize/=cameraZoomLevel,context.beginPath(),context.strokeStyle=color,context.lineWidth=2/cameraZoomLevel,alignCoordinateSystem?(context.moveTo(pos.x-halfSize,pos.y),context.lineTo(pos.x+halfSize,pos.y),context.moveTo(pos.x,pos.y-halfSize),context.lineTo(pos.x,pos.y+halfSize)):(context.moveTo(pos.x-halfSize,-pos.y),context.lineTo(pos.x+halfSize,-pos.y),context.moveTo(pos.x,-pos.y-halfSize),context.lineTo(pos.x,-pos.y+halfSize)),context.stroke(),context.lineWidth=3}function drawBoundingBox(context,boundaries,alignCoordinateSystem){if(!boundariesFullyDefined(boundaries))return;const width=translationWidthOf(boundaries),height=translationHeightOf(boundaries),curMin=null==boundaries?void 0:boundaries.min,curMinX=null==curMin?void 0:curMin.x,curMinY=null==curMin?void 0:curMin.y;null!=curMinX&&null!=curMinY&&null!=width&&null!=height&&(context.beginPath(),context.strokeStyle=\"blue\",context.lineWidth=100,alignCoordinateSystem?context.roundRect(curMinX,curMinY,width,height,5):context.roundRect(curMinX,-curMinY,width,-height,5),context.stroke(),context.lineWidth=3,context.strokeStyle=\"black\")}function drawAxis(context,boundaries,zoomLevel,alignCoordinateSystem){if(!boundariesFullyDefined(boundaries))return;const width=translationWidthOf(boundaries),height=translationHeightOf(boundaries),curMin=null==boundaries?void 0:boundaries.min,curMinX=null==curMin?void 0:curMin.x,curMinY=null==curMin?void 0:curMin.y;null!=curMinX&&null!=curMinY&&null!=width&&null!=height&&(context.lineWidth=1/zoomLevel,context.beginPath(),context.strokeStyle=\"rgba(87, 173, 72, 0.8)\",context.moveTo(0,0),alignCoordinateSystem?context.lineTo(0,curMinY+height):context.lineTo(0,-curMinY-height),context.stroke(),context.beginPath(),context.strokeStyle=\"rgba(220, 59, 59, 0.8)\",context.moveTo(0,0),context.lineTo(curMinX+width,0),context.stroke(),context.strokeStyle=\"black\")}function drawGrid(context,topLeftCorner,topRightCorner,bottomLeftCorner,bottomRightCorner,alignCoordinateSystem,cameraZoomLevel,viewPortWidth,viewPortHeight){PointCal.unitVectorFromA2B(topLeftCorner,topRightCorner),PointCal.unitVectorFromA2B(bottomLeftCorner,topLeftCorner);let width=PointCal.distanceBetweenPoints(topLeftCorner,topRightCorner),orderOfMagnitude=calculateOrderOfMagnitude(width),subDivisor=Math.pow(10,orderOfMagnitude)/10,minHorizontalSmallTick=Math.ceil(topLeftCorner.x/subDivisor)*subDivisor,maxHorizontalSmallTick=Math.floor(topRightCorner.x/subDivisor)*subDivisor,minVerticalSmallTick=alignCoordinateSystem?Math.floor(topLeftCorner.y/subDivisor)*subDivisor:Math.ceil(bottomLeftCorner.y/subDivisor)*subDivisor,maxVerticalSmallTick=alignCoordinateSystem?Math.ceil(bottomLeftCorner.y/subDivisor)*subDivisor:Math.floor(topLeftCorner.y/subDivisor)*subDivisor;for(let i=minHorizontalSmallTick;i<=maxHorizontalSmallTick;i+=subDivisor)context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=.5/cameraZoomLevel,alignCoordinateSystem?(context.moveTo(i,topLeftCorner.y),context.lineTo(i,topLeftCorner.y+viewPortHeight/cameraZoomLevel)):(context.moveTo(i,-topLeftCorner.y),context.lineTo(i,-topLeftCorner.y+viewPortHeight/cameraZoomLevel)),context.stroke();for(let i=minVerticalSmallTick;i<=maxVerticalSmallTick;i+=subDivisor)context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=.5/cameraZoomLevel,alignCoordinateSystem?(context.moveTo(topLeftCorner.x,i),context.lineTo(topLeftCorner.x+width/cameraZoomLevel,i)):(context.moveTo(topLeftCorner.x,-i),context.lineTo(topLeftCorner.x+width/cameraZoomLevel,-i)),context.stroke()}function drawRuler(context,topLeftCorner,topRightCorner,bottomLeftCorner,bottomRightCorner,alignCoordinateSystem,cameraZoomLevel){let leftRightDirection=PointCal.unitVectorFromA2B(topLeftCorner,topRightCorner),topDownDirection=PointCal.unitVectorFromA2B(bottomLeftCorner,topLeftCorner),orderOfMagnitude=calculateOrderOfMagnitude(PointCal.distanceBetweenPoints(topLeftCorner,topRightCorner)),divisor=Math.pow(10,orderOfMagnitude),halfDivisor=divisor/2,subDivisor=divisor/10,minHorizontalLargeTick=Math.ceil(topLeftCorner.x/divisor)*divisor,maxHorizontalLargeTick=Math.floor(topRightCorner.x/divisor)*divisor,minVerticalLargeTick=alignCoordinateSystem?Math.ceil(topLeftCorner.y/divisor)*divisor:Math.floor(bottomLeftCorner.y/divisor)*divisor,maxVerticalLargeTick=alignCoordinateSystem?Math.floor(bottomLeftCorner.y/divisor)*divisor:Math.ceil(topLeftCorner.y/divisor)*divisor,minHorizontalMediumTick=Math.ceil(topLeftCorner.x/halfDivisor)*halfDivisor,maxHorizontalMediumTick=Math.floor(topRightCorner.x/halfDivisor)*halfDivisor,minVerticalMediumTick=alignCoordinateSystem?Math.ceil(topLeftCorner.y/halfDivisor)*halfDivisor:Math.floor(bottomLeftCorner.y/halfDivisor)*halfDivisor,maxVerticalMediumTick=alignCoordinateSystem?Math.floor(bottomLeftCorner.y/halfDivisor)*halfDivisor:Math.ceil(topLeftCorner.y/halfDivisor)*halfDivisor,minHorizontalSmallTick=Math.ceil(topLeftCorner.x/subDivisor)*subDivisor,maxHorizontalSmallTick=Math.floor(topRightCorner.x/subDivisor)*subDivisor,minVerticalSmallTick=alignCoordinateSystem?Math.ceil(topLeftCorner.y/subDivisor)*subDivisor:Math.floor(bottomLeftCorner.y/subDivisor)*subDivisor,maxVerticalSmallTick=alignCoordinateSystem?Math.floor(bottomLeftCorner.y/subDivisor)*subDivisor:Math.ceil(topLeftCorner.y/subDivisor)*subDivisor,halfDivisorInActualPixel=halfDivisor*cameraZoomLevel,subDivisorInActualPixel=subDivisor*cameraZoomLevel;context.font=`bold ${20/cameraZoomLevel}px Helvetica`;const midBaseLineTextDimensions=context.measureText(\"\"+-(halfDivisor+minHorizontalMediumTick)),midBaseLineHeight=midBaseLineTextDimensions.fontBoundingBoxAscent+midBaseLineTextDimensions.fontBoundingBoxDescent,subBaseLineTextDimensions=context.measureText(\"\"+-(subDivisor+minHorizontalSmallTick)),subBaseLineHeight=subBaseLineTextDimensions.fontBoundingBoxAscent+subBaseLineTextDimensions.fontBoundingBoxDescent;for(let i=minHorizontalLargeTick;i<=maxHorizontalLargeTick;i+=divisor){context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=5/cameraZoomLevel;let resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,50/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,-50/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.textAlign=\"center\",context.textBaseline=\"middle\",context.font=`bold ${20/cameraZoomLevel}px Helvetica`;const textDimensions=context.measureText(`${i.toFixed(0)}`),height=textDimensions.fontBoundingBoxAscent+textDimensions.fontBoundingBoxDescent;alignCoordinateSystem?(resPoint=PointCal.addVector(resPoint,{x:0,y:height/2+.2*height}),context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y)):(resPoint=PointCal.addVector(resPoint,{x:0,y:-height/2-.2*height}),context.fillText(`${i.toFixed(0)}`,resPoint.x,-resPoint.y)),context.stroke()}for(let i=minVerticalLargeTick;i<=maxVerticalLargeTick;i+=divisor){context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=5/cameraZoomLevel;let resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,-50/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,50/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.textAlign=\"center\",context.textBaseline=\"middle\",context.font=`bold ${20/cameraZoomLevel}px Helvetica`;const textDimensions=context.measureText(`${i.toFixed(0)}`);resPoint=PointCal.addVector(resPoint,{x:textDimensions.width/2+.3*textDimensions.width,y:0}),alignCoordinateSystem?context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y):context.fillText(`${i.toFixed(0)}`,resPoint.x,-resPoint.y),context.stroke()}for(let i=minHorizontalMediumTick;i<=maxHorizontalMediumTick;i+=halfDivisor){if(i%divisor==0)continue;context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=3/cameraZoomLevel;let resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,25/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,-25/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.font=15/cameraZoomLevel+\"px Helvetica\";const textDimensions=context.measureText(`${i.toFixed(0)}`);if(halfDivisorInActualPixel>2*midBaseLineTextDimensions.width){context.textAlign=\"center\",context.textBaseline=\"middle\";const height=textDimensions.fontBoundingBoxAscent+textDimensions.fontBoundingBoxDescent;alignCoordinateSystem?resPoint=PointCal.addVector(resPoint,{x:0,y:height/2+.2*height}):(resPoint=PointCal.addVector(resPoint,{x:0,y:-height/2-.2*height}),resPoint=PointCal.flipYAxis(resPoint)),context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y)}context.stroke()}for(let i=minVerticalMediumTick;i<=maxVerticalMediumTick;i+=halfDivisor){if(i%divisor==0)continue;context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=3/cameraZoomLevel;let resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,-25/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,25/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.font=18/cameraZoomLevel+\"px Helvetica\";const textDimensions=context.measureText(`${i.toFixed(0)}`);textDimensions.fontBoundingBoxAscent,textDimensions.fontBoundingBoxDescent,halfDivisorInActualPixel>2*midBaseLineHeight&&(context.textAlign=\"center\",context.textBaseline=\"middle\",resPoint=PointCal.addVector(resPoint,{x:textDimensions.width/2+.3*textDimensions.width,y:0}),alignCoordinateSystem||(resPoint=PointCal.flipYAxis(resPoint)),context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y)),context.stroke()}for(let i=minHorizontalSmallTick;i<=maxHorizontalSmallTick;i+=subDivisor){if(i%divisor==0||i%halfDivisor==0)continue;context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=1/cameraZoomLevel;let resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,12.5/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:i,y:topLeftCorner.y},PointCal.multiplyVectorByScalar(topDownDirection,-12.5/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.font=10/cameraZoomLevel+\"px Helvetica\";const textDimensions=context.measureText(`${i.toFixed(0)}`);if(subDivisorInActualPixel>2*subBaseLineTextDimensions.width){context.textAlign=\"center\",context.textBaseline=\"middle\";const height=textDimensions.fontBoundingBoxAscent+textDimensions.fontBoundingBoxDescent;alignCoordinateSystem?resPoint=PointCal.addVector(resPoint,{x:0,y:height/2+.2*height}):(resPoint=PointCal.addVector(resPoint,{x:0,y:-height/2-.2*height}),resPoint=PointCal.flipYAxis(resPoint)),context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y)}context.stroke()}for(let i=minVerticalSmallTick;i<=maxVerticalSmallTick;i+=subDivisor){if(i%divisor==0||i%halfDivisor==0)continue;context.beginPath(),context.strokeStyle=\"black\",context.fillStyle=\"black\",context.lineWidth=1/cameraZoomLevel;let resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,-12.5/cameraZoomLevel));alignCoordinateSystem?context.moveTo(resPoint.x,resPoint.y):context.moveTo(resPoint.x,-resPoint.y),resPoint=PointCal.addVector({x:topLeftCorner.x,y:i},PointCal.multiplyVectorByScalar(leftRightDirection,12.5/cameraZoomLevel)),alignCoordinateSystem?context.lineTo(resPoint.x,resPoint.y):context.lineTo(resPoint.x,-resPoint.y),context.font=12/cameraZoomLevel+\"px Helvetica\";const textDimensions=context.measureText(`${i.toFixed(0)}`);textDimensions.fontBoundingBoxAscent,textDimensions.fontBoundingBoxDescent,subDivisorInActualPixel>2*subBaseLineHeight&&(context.textAlign=\"center\",context.textBaseline=\"middle\",resPoint=PointCal.addVector(resPoint,{x:textDimensions.width/2+.3*textDimensions.width,y:0}),alignCoordinateSystem||(resPoint=PointCal.flipYAxis(resPoint)),context.fillText(`${i.toFixed(0)}`,resPoint.x,resPoint.y)),context.stroke()}}function drawPositionText(context,pos,cameraZoomLevel,alignCoordinateSystem,offset=20,color=\"red\"){offset/=cameraZoomLevel,context.font=20/cameraZoomLevel+\"px Arial\",context.fillStyle=color,alignCoordinateSystem?context.fillText(`x: ${pos.x.toFixed(2)}, y: ${pos.y.toFixed(2)}`,pos.x+offset,pos.y+offset):context.fillText(`x: ${pos.x.toFixed(2)}, y: ${pos.y.toFixed(2)}`,pos.x+offset,-pos.y-offset),context.fillStyle=\"black\"}function drawReferenceCircle(context,pos,alignCoordinateSystem){context.beginPath(),context.strokeStyle=\"rgba(87, 173, 72, 0.8)\",alignCoordinateSystem?context.arc(pos.x,pos.y,5,0,2*Math.PI):context.arc(pos.x,-pos.y,5,0,2*Math.PI),context.stroke(),context.strokeStyle=\"black\"}class BoardStateObserver{constructor(camera){this.cameraSubscribers=[],this.panHandlerSubscribers=[],this.zoomHandlerSubscribers=[],this.rotationHandlerSubscribers=[],this._camera=camera}subscribeToCamera(subscriber){this.cameraSubscribers.push(subscriber)}unsubscribeToCamera(subscriber){this.cameraSubscribers=this.cameraSubscribers.filter((sub=>sub!==subscriber))}subscribeToPanHandler(subscriber){this.panHandlerSubscribers.push(subscriber)}unsubscribeToPanHandler(subscriber){this.panHandlerSubscribers=this.panHandlerSubscribers.filter((sub=>sub!==subscriber))}subscribeToZoomHandler(subscriber){this.zoomHandlerSubscribers.push(subscriber)}unsubscribeToZoomHandler(subscriber){this.zoomHandlerSubscribers=this.zoomHandlerSubscribers.filter((sub=>sub!==subscriber))}subscribeToRotationHandler(subscriber){return this.rotationHandlerSubscribers.push(subscriber),()=>{this.rotationHandlerSubscribers=this.rotationHandlerSubscribers.filter((sub=>sub!==subscriber))}}get camera(){return this._camera}set camera(camera){this._camera=camera,this.notifyCameraChange()}get panHandler(){return this._panHandler}set panHandler(panHandler){this._panHandler=panHandler,this.notifyPanHandlerChange()}get zoomHandler(){return this._zoomHandler}set zoomHandler(zoomHandler){this._zoomHandler=zoomHandler,this.notifyZoomHandlerChange()}get rotationHandler(){return this._rotationHandler}set rotationHandler(rotationHandler){this._rotationHandler=rotationHandler,this.notifyRotationHandlerChange()}notifyCameraChange(){this.cameraSubscribers.forEach((sub=>sub.updateCamera(this._camera)))}notifyPanHandlerChange(){this.panHandlerSubscribers.forEach((sub=>sub.updatePanHandler(this._panHandler)))}notifyZoomHandlerChange(){this.zoomHandlerSubscribers.forEach((sub=>sub.updateZoomHandler(this._zoomHandler)))}notifyRotationHandlerChange(){this.rotationHandlerSubscribers.forEach((sub=>sub.updateRotationHandler(this._rotationHandler)))}}class InputObserver{constructor(controlCenter){this.panCallbackList=[],this.zoomCallbackList=[],this.rotateCallbackList=[],this._controlCenter=controlCenter}notifyOnPan(camera,diff){this._controlCenter.notifyPanInput(camera,diff),this.panCallbackList.forEach((callback=>{queueMicrotask((()=>{callback({diff:diff})}))}))}notifyOnZoom(camera,deltaZoomAmount,anchorPoint){this._controlCenter.notifyZoomInput(camera,deltaZoomAmount,anchorPoint),this.zoomCallbackList.forEach((callback=>{queueMicrotask((()=>{callback({deltaZoomAmount:deltaZoomAmount,anchorPoint:anchorPoint})}))}))}notifyOnRotation(camera,deltaRotation){this._controlCenter.notifyRotationInput(camera,deltaRotation),this.rotateCallbackList.forEach((callback=>{queueMicrotask((()=>{callback({deltaRotation:deltaRotation})}))}))}onInput(eventName,callback){switch(eventName){case\"pan\":return this.panCallbackList.push(callback),()=>{this.panCallbackList=this.panCallbackList.filter((cb=>cb!==callback))};case\"zoom\":return this.zoomCallbackList.push(callback),()=>{this.zoomCallbackList=this.zoomCallbackList.filter((cb=>cb!==callback))};case\"rotate\":return this.rotateCallbackList.push(callback),()=>{this.rotateCallbackList=this.rotateCallbackList.filter((cb=>cb!==callback))};default:throw new Error(\"Invalid input event name\")}}get controlCenter(){return this._controlCenter}set controlCenter(value){this._controlCenter=value}}class SimpleRelay{constructor(panHandler,zoomHandler,rotationHandler){this._panController=panHandler,this._zoomController=zoomHandler,this._rotationController=rotationHandler}get panController(){return this._panController}get zoomController(){return this._zoomController}get rotationController(){return this._rotationController}notifyPanInput(camera,diff){this._panController.panCameraBy(camera,diff)}notifyZoomInput(camera,deltaZoomAmount,anchorPoint){this._zoomController.zoomCameraToAt(camera,camera.zoomLevel+deltaZoomAmount,anchorPoint)}notifyRotationInput(camera,deltaRotation){this._rotationController.rotateCameraBy(camera,deltaRotation)}}class Board{constructor(canvas){this._alignCoordinateSystem=!0,this._fullScreen=!1,this.lastUpdateTime=0,this._canvas=canvas,this.boardStateObserver=new BoardStateObserver(new BoardCameraV2),this.boardStateObserver.camera.viewPortHeight=canvas.height,this.boardStateObserver.camera.viewPortWidth=canvas.width,this.boardStateObserver.camera.boundaries={min:{x:-5e3,y:-5e3},max:{x:5e3,y:5e3}};let context=canvas.getContext(\"2d\");if(null==context)throw new Error(\"Canvas 2d context is null\");this._context=context;let panHandler=new PanRig,zoomHandler=new ZoomRig(panHandler),rotationHandler=new RotationRig;this.bindFunctions(),this.attributeObserver=new MutationObserver(this.attributeCallBack),this.attributeObserver.observe(this._canvas,{attributes:!0}),this.windowResizeObserver=new ResizeObserver(this.windowResizeHandler),this.windowResizeObserver.observe(document.body),this.boardInputObserver=new InputObserver(new SimpleRelay(panHandler,zoomHandler,rotationHandler)),this._kmtStrategy=new DefaultBoardKMTStrategy(this._canvas,this.boardStateObserver.camera,this.boardInputObserver),this.boardStateObserver.subscribeToCamera(this._kmtStrategy),this._touchStrategy=new DefaultTouchStrategy(this._canvas,this.boardStateObserver.camera,this.boardInputObserver),this.boardStateObserver.subscribeToCamera(this._touchStrategy),this.registerEventListeners()}registerEventListeners(){this._kmtStrategy.setUp(),this._touchStrategy.setUp()}removeEventListeners(){this._touchStrategy.tearDown(),this._kmtStrategy.tearDown()}setup(){this.registerEventListeners(),this.windowResizeObserver.observe(document.body),this.attributeObserver.observe(this._canvas,{attributes:!0})}tearDown(){this.removeEventListeners(),this.windowResizeObserver.disconnect(),this.attributeObserver.disconnect()}bindFunctions(){this.step=this.step.bind(this),this.attributeCallBack=this.attributeCallBack.bind(this),this.windowResizeHandler=this.windowResizeHandler.bind(this)}set width(width){if(this._canvas.width=width,this.boardStateObserver.camera.viewPortWidth=width,this.boardInputObserver.controlCenter.panController.limitEntireViewPort){const targetMinZoomLevel=minZoomLevelBaseOnWidth(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);null!=targetMinZoomLevel&&zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}get width(){return this._canvas.width}set height(height){if(this._canvas.height=height,this.boardStateObserver.camera.viewPortHeight=height,this.boardInputObserver.controlCenter.panController.limitEntireViewPort){const targetMinZoomLevel=minZoomLevelBaseOnHeight(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);null!=targetMinZoomLevel&&zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}get height(){return this._canvas.height}set alignCoordinateSystem(align){this._alignCoordinateSystem=align,this._kmtStrategy.alignCoordinateSystem=align,this._touchStrategy.alignCoordinateSystem=align}get alignCoordinateSystem(){return this._alignCoordinateSystem}get fullScreen(){return this._fullScreen}set fullScreen(value){this._fullScreen=value,this._fullScreen&&(this.width=window.innerWidth,this.height=window.innerHeight)}get context(){return this._context}set limitEntireViewPort(value){if(this.boardInputObserver.controlCenter.panController.limitEntireViewPort=value,value){const targetMinZoomLevel=minZoomLevelBaseOnDimensions(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);null!=targetMinZoomLevel&&zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}get limitEntireViewPort(){return this.boardInputObserver.controlCenter.panController.limitEntireViewPort}set kmtStrategy(strategy){this._kmtStrategy.tearDown(),this.boardStateObserver.unsubscribeToCamera(this._kmtStrategy),strategy.setUp(),this._kmtStrategy=strategy,this.boardStateObserver.subscribeToCamera(this._kmtStrategy),this._kmtStrategy.camera=this.boardStateObserver.camera}get kmtStrategy(){return this._kmtStrategy}set touchStrategy(strategy){this._touchStrategy.tearDown(),this.boardStateObserver.unsubscribeToCamera(this._touchStrategy),strategy.setUp(),this._touchStrategy=strategy,this.boardStateObserver.subscribeToCamera(this._touchStrategy),this._touchStrategy.camera=this.boardStateObserver.camera}get touchStrategy(){return this._touchStrategy}get camera(){return this.boardStateObserver.camera}set camera(camera){camera.viewPortHeight=this._canvas.height,camera.viewPortWidth=this._canvas.width,this.boardStateObserver.camera=camera}set panHandler(handler){this.boardInputObserver.controlCenter.panController=handler}get panHandler(){return this.boardInputObserver.controlCenter.panController}set zoomHandler(handler){this.boardStateObserver.zoomHandler=handler}get zoomHandler(){return this.boardStateObserver.zoomHandler}set controlCenter(controlCenter){let tempPanHandler=this.boardInputObserver.controlCenter.panController,tempZoomHandler=this.boardInputObserver.controlCenter.zoomController,tempRotationHandler=this.boardInputObserver.controlCenter.rotationController;controlCenter.panController=tempPanHandler,controlCenter.zoomController=tempZoomHandler,controlCenter.rotationController=tempRotationHandler,this.boardInputObserver.controlCenter=controlCenter}get controlCenter(){return this.boardInputObserver.controlCenter}step(timestamp){this.lastUpdateTime,this.lastUpdateTime=timestamp,this._context.reset();const curBoundaries=this.boardStateObserver.camera.boundaries;if(!boundariesFullyDefined(curBoundaries))throw new Error(\"Boundaries are not fully defined; not able to clear the canvas under the current implementation\");this._context.clearRect(curBoundaries.min.x,-curBoundaries.min.y,curBoundaries.max.x-curBoundaries.min.x,-(curBoundaries.max.y-curBoundaries.min.y)),this._context.translate(this._canvas.width/2,this._canvas.height/2),this._context.scale(this.boardStateObserver.camera.zoomLevel,this.boardStateObserver.camera.zoomLevel),this._alignCoordinateSystem?(this._context.rotate(-this.boardStateObserver.camera.rotation),this._context.translate(-this.boardStateObserver.camera.position.x,-this.boardStateObserver.camera.position.y)):(this._context.rotate(this.boardStateObserver.camera.rotation),this._context.translate(-this.boardStateObserver.camera.position.x,this.boardStateObserver.camera.position.y))}convertWindowPoint2ViewPortPoint(bottomLeftCornerOfCanvas,clickPointInWindow){const res=PointCal.subVector(clickPointInWindow,bottomLeftCornerOfCanvas);return this._alignCoordinateSystem?{x:res.x,y:res.y}:{x:res.x,y:-res.y}}convertWindowPoint2WorldCoord(clickPointInWindow){if(this._alignCoordinateSystem){const pointInCameraViewPort=this.convertWindowPoint2ViewPortPoint({y:this._canvas.getBoundingClientRect().top,x:this._canvas.getBoundingClientRect().left},clickPointInWindow);return this.boardStateObserver.camera.convertFromViewPort2WorldSpace(pointInCameraViewPort)}{const pointInCameraViewPort=this.convertWindowPoint2ViewPortPoint({y:this._canvas.getBoundingClientRect().bottom,x:this._canvas.getBoundingClientRect().left},clickPointInWindow);return this.boardStateObserver.camera.convertFromViewPort2WorldSpace(pointInCameraViewPort)}}on(eventName,callback){return this.boardStateObserver.camera.on(eventName,callback)}onInput(eventName,callback){return this.boardInputObserver.onInput(eventName,callback)}get maxHalfTransHeight(){return function(boundaries){const translationHeight=translationHeightOf(boundaries);return null!=translationHeight?translationHeight/2:void 0}(this.boardStateObserver.camera.boundaries)}get maxHalfTransWidth(){return function(boundaries){const translationWidth=translationWidthOf(boundaries);return null!=translationWidth?translationWidth/2:void 0}(this.boardStateObserver.camera.boundaries)}attributeCallBack(mutationsList,observer){for(let mutation of mutationsList)if(\"attributes\"===mutation.type)if(\"width\"===mutation.attributeName){if(this.boardStateObserver.camera.viewPortWidth=this._canvas.width,this.limitEntireViewPort){const targetMinZoomLevel=minZoomLevelBaseOnWidth(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}else if(\"height\"===mutation.attributeName&&(this.boardStateObserver.camera.viewPortHeight=this._canvas.height,this.limitEntireViewPort)){const targetMinZoomLevel=minZoomLevelBaseOnHeight(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}windowResizeHandler(){this._fullScreen&&(this.width=window.innerWidth,this.height=window.innerHeight)}setMaxTransWidthAlignedMin(value){const curBoundaries=this.boardStateObserver.camera.boundaries,curMin=null==curBoundaries?void 0:curBoundaries.min,curHorizontalMin=null==curMin?void 0:curMin.x;if(null==curHorizontalMin?this.boardStateObserver.camera.setHorizontalBoundaries(-value,value):this.boardStateObserver.camera.setHorizontalBoundaries(curHorizontalMin,curHorizontalMin+2*value),this.limitEntireViewPort){const targetMinZoomLevel=minZoomLevelBaseOnWidth(this.boardStateObserver.camera.boundaries,this._canvas.width,this._canvas.height,this.boardStateObserver.camera.rotation);zoomLevelBoundariesShouldUpdate(this.boardStateObserver.camera.zoomBoundaries,targetMinZoomLevel)&&this.boardStateObserver.camera.setMinZoomLevel(targetMinZoomLevel)}}}export{BoardStateObserver,Board as default,drawAxis,drawBoundingBox,drawCrossHair,drawGrid,drawPositionText,drawReferenceCircle,drawRuler,minZoomLevelBaseOnDimensions,minZoomLevelBaseOnHeight,minZoomLevelBaseOnWidth,zoomLevelBoundariesShouldUpdate};\n//# sourceMappingURL=index.js.map\n","import Board from \"@niuee/board/boardify\";\nimport { Point } from \"@niuee/board\";\n\n\nlet element = document.getElementById(\"test-graph\") as HTMLCanvasElement;\nlet board = new Board(element);\nboard.fullScreen = true;\nlet button = document.querySelector(\"#start-recording\") as HTMLButtonElement;\nlet clearCanvasbutton = document.querySelector(\"#clear-canvas-button\") as HTMLButtonElement;\nlet recording = false;\nlet startTime = 0;\nlet curTime = 0;\nlet pathPoints: PathPoint[] = [];\nlet recordedPath: PathPoint[] = [];\nif (button) {\n    button.onclick = ()=>{\n        if(recording){\n            console.log(\"recorder path\", recordedPath);\n        }\n        startTime = curTime;\n        recordedPath = [];\n        recording = !recording;\n    }\n}\nif(clearCanvasbutton){\n    clearCanvasbutton.onclick = ()=>{\n        pathPoints = [];\n    }\n}\n\nlet isDrawing = false;\nlet hue = 0;\nlet lastPoint: Point = undefined;\ntype PathPoint = {\n    startPoint: Point;\n    endPoint: Point;\n    strokeStyle: string;\n    timePercentage: number;\n}\n\nelement.addEventListener('touchstart', (e)=>{\n    isDrawing = true;\n    lastPoint = board.convertWindowPoint2WorldCoord({x: e.targetTouches[0].clientX, y: e.targetTouches[0].clientY});\n});\n\nelement.addEventListener('touchend', (e)=>{\n    isDrawing = false;\n});\n\nelement.addEventListener('touchcancel', (e)=>{\n    isDrawing = false;\n});\n\nelement.addEventListener('touchmove', (e)=>{\n    if(e.targetTouches.length == 1 && isDrawing){\n        let curPoint = board.convertWindowPoint2WorldCoord({x: e.targetTouches[0].clientX, y: e.targetTouches[0].clientY});\n        pathPoints.push({\n            startPoint: {...lastPoint},\n            endPoint: {...curPoint},\n            strokeStyle: `hsl(${hue}, 60%, 60%)`,\n            timePercentage: 0\n        })\n        // Array destructuring\n        if (recording){\n            recordedPath.push({\n                startPoint: {...lastPoint},\n                endPoint: {...curPoint},\n                strokeStyle: `hsl(${hue}, 60%, 60%)`,\n                timePercentage: curTime - startTime,\n            })\n        }\n        lastPoint = curPoint;\n        hue = (hue + 1) % 360;\n    }\n});\n\nconst ctx = board.context;\nfunction step(timestamp: number){\n    board.step(timestamp);\n    curTime = timestamp;\n    pathPoints.forEach((point)=>{\n        ctx.strokeStyle = point.strokeStyle;\n        ctx.beginPath();\n        // start from\n        ctx.moveTo(point.startPoint.x, -point.startPoint.y);\n        // go to\n        ctx.lineTo(point.endPoint.x, -point.endPoint.y);\n        ctx.stroke();\n    });\n    window.requestAnimationFrame(step);\n}\n\nwindow.requestAnimationFrame(step);"],"names":["clampZoomLevel","zoomLevel","zoomLevelLimits","zoomLevelWithinLimits","max","Math","min","PointCal","addVector","a","b","z","x","y","subVector","multiplyVectorByScalar","divideVectorByScalar","magnitude","sqrt","unitVector","this","dotProduct","crossProduct","unitVectorFromA2B","rotatePoint","point","angle","cos","sin","transform2NewAxis","angleFromOriginalAxis2DestAxis","angleFromA2B","atan2","transformPointWRTAnchor","anchor","newPoint","distanceBetweenPoints","flipYAxis","linearInterpolation","t","isEqual","getLineIntersection","startPoint","endPoint","startPoint2","endPoint2","numerator","denominator","intersects","intersection","offset","convert2WorldSpaceWRT","targetPosition","interestPoint","viewPortWidth","viewPortHeight","cameraZoomLevel","cameraRotation","cameraFrameCenter","delta2Point","convert2WorldSpace","cameraPosition","withinBoundaries","boundaries","leftSide","rightSide","topSide","bottomSide","clampPoint","manipulatePoint","limit","translationWidthOf","translationHeightOf","clampPointEntireViewPort","topLeftCorner","bottomLeftCorner","topRightCorner","bottomRightCorner","topLeftCornerClamped","topRightCornerClamped","bottomLeftCornerClamped","bottomRightCornerClamped","diffs","maxXDiff","abs","maxYDiff","delta","forEach","diff","clampRotation","rotation","rotationLimits","rotationWithinLimits","normalizeAngleZero2TwoPI","angleSpanFromStart","angleSpan","start","angleSpanFromEnd","end","ccw","startAsTieBreaker","PI","from","to","angleDiff","PanHandlerBoilerPlate","constructor","nextHandler","_nextHandler","handler","chainHandler","panCameraTo","camera","destination","panCameraBy","BasePanHandler","super","setPosition","position","ClampHandler","_entireViewPort","entireViewPort","actualDest","actualDelta","PanWithRestriction","_restrictXTranslation","_restrictYTranslation","_restrictRelativeXTranslation","_restrictRelativeYTranslation","restrictXTranslation","restrictYTranslation","restrictRelativeXTranslation","restrictRelativeYTranslation","convertDeltaToComplyWithRestriction","upDirection","value","rightDirection","dest","PanRig","restrictionHandler","restrictTranslation","limitEntireViewPort","clampHandler","baseHandler","RotationHandlerBoilerPlate","rotateCameraTo","targetRotation","rotateCameraBy","BaseRotationHandler","setRotation","curRotation","RotationRestrictionHandler","_restrictRotation","restrictRotation","RotationClampHandler","rotationBoundaries","RotationRig","_restrictionHandler","_baseHandler","_clampHandler","ZoomHandlerBoilerPlate","zoomCameraTo","targetZoom","zoomCameraBy","zoomCameraToAt","at","zoomCameraByAt","BaseZoomHandler","panHandler","setZoomLevel","originalAnchorInWorld","anchorInWorldAfterZoom","ZoomClampHandler","zoomBoundaries","zoomByAt","ZoomRestrictionHandler","_restrictZoom","restrictZoom","ZoomRig","basePanHandler","restrict","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","throw","result","done","then","apply","SuppressedError","CameraObserverV2","panCallbackList","zoomCallbackList","rotateCallbackList","notifyPositionChange","cameraState","queueMicrotask","callback","notifyZoomChange","deltaZoomAmount","notifyRotationChange","deltaRotation","on","eventName","push","filter","cb","clearCallbacks","BoardCameraV2","cameraObserver","_position","_zoomLevel","_rotation","_viewPortHeight","_viewPortWidth","_observer","_boundaries","width","height","observer","_zoomBoundaries","temp","setMaxZoomLevel","maxZoomLevel","setMinZoomLevel","minZoomLevel","curZoom","_rotationBoundaries","convertFromViewPort2WorldSpace","invertFromWorldSpace2ViewPort","setHorizontalBoundaries","setVerticalBoundaries","DefaultBoardKMTStrategy","canvas","inputObserver","debugMode","alignCoordinateSystem","_panDisabled","_zoomDisabled","_rotateDisabled","_keyController","Map","SCROLL_SENSATIVITY","isDragging","_canvas","_camera","_debugMode","_alignCoordinateSystem","bindFunctions","panDisabled","style","cursor","dragStartPoint","zoomDisabled","rotateDisabled","setUp","addEventListener","pointerDownHandler","pointerUpHandler","pointerMoveHandler","scrollHandler","window","keypressHandler","keyupHandler","setupKeyController","tearDown","removeEventListener","bind","keys","key","set","_disabled","pointerType","button","metaKey","get","clientX","clientY","disableStrategy","enableStrategy","target","diffInWorld","notifyOnPan","preventDefault","zoomAmount","deltaY","ctrlKey","cursorPosition","anchorPoint","getBoundingClientRect","left","top","bottom","notifyOnZoom","deltaX","has","updateCamera","disabled","DefaultTouchStrategy","controlCamera","ZOOM_SENSATIVITY","panInputCallBackList","zoomInputCallBackList","touchPoints","zoomStartDist","bindListeners","touchstartHandler","touchendHandler","touchcancelHandler","touchmoveHandler","resetAttributes","tapPoint","targetTouches","length","firstTouchPoint","secondTouchPoint","convertWindowPoint2ViewPortPoint","touchPointDist","distDiff","midPoint","touchPoint","bottomLeftCornerOfCanvas","clickPointInWindow","res","zoomLevelBoundariesShouldUpdate","zoomLevelBoundaries","targetMinZoomLevel","minZoomLevelBaseOnWidth","canvasWidth","canvasHeight","widthWidthProjection","widthHeightProjection","minZoomLevelBaseOnHeight","minZoomLevelHeightWidth","minZoomLevelHeightHeight","BoardStateObserver","cameraSubscribers","panHandlerSubscribers","zoomHandlerSubscribers","rotationHandlerSubscribers","subscribeToCamera","subscriber","unsubscribeToCamera","sub","subscribeToPanHandler","unsubscribeToPanHandler","subscribeToZoomHandler","unsubscribeToZoomHandler","subscribeToRotationHandler","notifyCameraChange","_panHandler","notifyPanHandlerChange","zoomHandler","_zoomHandler","notifyZoomHandlerChange","rotationHandler","_rotationHandler","notifyRotationHandlerChange","updatePanHandler","updateZoomHandler","updateRotationHandler","InputObserver","controlCenter","_controlCenter","notifyPanInput","notifyZoomInput","notifyOnRotation","notifyRotationInput","onInput","Error","SimpleRelay","_panController","_zoomController","_rotationController","panController","zoomController","rotationController","document","getElementById","board","_fullScreen","lastUpdateTime","boardStateObserver","context","getContext","_context","attributeObserver","MutationObserver","attributeCallBack","observe","attributes","windowResizeObserver","ResizeObserver","windowResizeHandler","body","boardInputObserver","_kmtStrategy","_touchStrategy","registerEventListeners","removeEventListeners","setup","disconnect","align","fullScreen","innerWidth","innerHeight","minZoomLevelWidthWidth","minZoomLevelWidthHeight","minZoomLevelHeight","minZoomLevelWidth","minZoomLevelBaseOnDimensions","kmtStrategy","strategy","touchStrategy","tempPanHandler","tempZoomHandler","tempRotationHandler","timestamp","reset","curBoundaries","clearRect","translate","scale","rotate","convertWindowPoint2WorldCoord","pointInCameraViewPort","maxHalfTransHeight","translationHeight","maxHalfTransWidth","translationWidth","mutationsList","mutation","type","attributeName","setMaxTransWidthAlignedMin","curMin","curHorizontalMin","querySelector","clearCanvasbutton","recording","startTime","curTime","pathPoints","recordedPath","onclick","console","log","lastPoint","isDrawing","hue","curPoint","strokeStyle","timePercentage","ctx","requestAnimationFrame","beginPath","moveTo","lineTo","stroke"],"sourceRoot":""}